#Project Setting
 
option(ENABLE_MPI "Enable MPI parallelization" ON)
set(MPI_NO_SYSTEM_PATHS ON) 
find_package(MPI)
if(MPI_FOUND)
    include_directories(${MPI_INCLUDE_DIR})
    set(CMAKE_C_FLAGS "${CMAKE_C_FLAGS} ${MPI_FLAGS}")
    set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} ${MPI_CXX_FLAGS}")
    set(CMAKE_EXE_LINKER_FLAGS "${CMAKE_EXE_LINKER_FLAGS} ${MPI_EXE_LINKER_FLAGS}")
    MESSAGE( STATUS "MPI_INCLUDE_DIRS = ${MPI_INCLUDE_DIR}") 
    MESSAGE( STATUS "MPI_VERSION = ${MPI_VERSION}")
    MESSAGE( "MPI setting successfully")
else()
    MESSAGE( "MPI setting faild")
endif()

set(Boost_NO_SYSTEM_PATHS ON) 
find_package(Boost)
if(Boost_FOUND)
	#add_compile_definitions(__REF_BOOST)
    include_directories(${Boost_INCLUDE_DIR})
    MESSAGE( STATUS "Boost_INCLUDE_DIR = ${Boost_INCLUDE_DIR}.")
    MESSAGE( STATUS "Boost_LIB_VERSION = ${Boost_LIB_VERSION}.")
    message("Boost setting successfully")
else()
    message("Boost setting failed")
endif()

include_directories		("${PROJECT_BINARY_DIR}" "${PROJECT_BINARY_DIR}/Core/Header" "${PROJECT_BINARY_DIR}/Extension/Header")
include_directories		("${PROJECT_BINARY_DIR}/Core" "${PROJECT_BINARY_DIR}/Extension")
aux_source_directory	(. Main_Cpp_List)
aux_source_directory	(./Core Core_Cpp_List)
aux_source_directory	(./Extension Extension_Cpp_List)
message( STATUS "main part cpp = ${Main_Cpp_List}")
message( STATUS "core part cpp = ${Core_Cpp_List}")
message( STATUS "extension part cpp = ${Extension_Cpp_List}")
add_executable (LightDiagram ${Main_Cpp_List} ${Core_Cpp_List} ${Extension_Cpp_List})

if(MPI_FOUND)
    target_link_libraries(LightDiagram ${MPI_LIBRARIES})
    set_property(TARGET LightDiagram PROPERTY MSVC_RUNTIME_LIBRARY "MultiThreaded$<$<CONFIG:Debug>:Debug>")
    message( STATUS "MPI_LIBRARIES = ${MPI_LIBRARIES}")
endif()

if(Boost_FOUND)
    target_link_libraries (LightDiagram ${Boost_LIBRARIES})
    message( STATUS "Boost_LIBRARIES = ${Boost_LIBRARIES}")
endif()

if (CMAKE_VERSION VERSION_GREATER 3.12)
  set_property(TARGET LightDiagram PROPERTY CXX_STANDARD 17)
endif()

#install(TARGETS LightDiagram)
